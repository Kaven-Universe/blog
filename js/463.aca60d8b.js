"use strict";(globalThis["webpackChunkkaven_blog"]=globalThis["webpackChunkkaven_blog"]||[]).push([[463],{80463:(e,t,a)=>{a.r(t),a.d(t,{default:()=>G});var n=a(22290);const s={class:"main-content"},i={class:"q-gutter-md row items-start"};function o(e,t,a,o,r,l){const u=(0,n.up)("Chart"),d=(0,n.up)("q-card-section"),c=(0,n.up)("q-icon"),m=(0,n.up)("q-input"),p=(0,n.up)("q-space"),h=(0,n.up)("q-toggle"),f=(0,n.up)("q-card");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(f,{flat:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,{ref:"chart",options:e.options},null,8,["options"])])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n._)("div",i,[(0,n.Wm)(m,{standout:"",modelValue:e.frequency,"onUpdate:modelValue":t[0]||(t[0]=t=>e.frequency=t),modelModifiers:{number:!0},type:"number",prefix:"Frequency:",suffix:"hz"},{prepend:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"mail"})])),_:1},8,["modelValue"]),(0,n.Wm)(m,{standout:"",modelValue:e.sampleRate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.sampleRate=t),modelModifiers:{number:!0},type:"number",prefix:"Sample Rate:",suffix:"hz"},{prepend:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"mail"})])),_:1},8,["modelValue"]),(0,n.Wm)(m,{standout:"",modelValue:e.delay,"onUpdate:modelValue":t[2]||(t[2]=t=>e.delay=t),modelModifiers:{number:!0},type:"number",prefix:"Delay:",suffix:"ms"},{prepend:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"mail"})])),_:1},8,["modelValue"]),(0,n.Wm)(p),(0,n.Wm)(h,{modelValue:e.isRefresh,"onUpdate:modelValue":t[3]||(t[3]=t=>e.isRefresh=t),label:"Refresh"},null,8,["modelValue"])])])),_:1})])),_:1})])}var r=a(57342);const l={class:""},u={class:"",ref:"chart",style:{height:"25rem"}};function d(e,t,a,s,i,o){return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",u,null,512)])}var c=a(1530),m=a(92385);const p=(0,c.iH)();let h;const f=(0,n.aZ)({name:"ChartViewer",props:{options:{type:Object,required:!0}},computed:{Chart(){return h}},setup(){return{chart:p}},mounted(){p.value&&(console.info("chart initialize"),h=(0,m.S1)(p.value),h.setOption(this.$props.options,!0))}});var y=a(60188);const v=(0,y.Z)(f,[["render",d]]),_=v;var S=a(72799),g=a(36416),x=a(37374);
/********************************************************************
 * @author:      Kaven
 * @email:       kaven@wuwenkai.com
 * @file:        [kaven-blog] /src/socket/Socket.ts
 * @create:      2019-11-08 16:41:23.053
 * @modify:      2023-07-12 09:54:48.854
 * @version:     0.0.2
 * @times:       36
 * @lines:       79
 * @copyright:   Copyright Â© 2019-2023 Kaven. All Rights Reserved.
 * @description: [description]
 * @license:     [license]
 ********************************************************************/
class A extends S.Y{constructor(){super((0,g.io)()),this.Socket.on("disconnect",(e=>{console.info(`socket disconnected: ${this.Socket.id}, ${e}`),"io server disconnect"===e&&this.Socket.connect()})),this.Socket.on(x.D2,(e=>{const t=new Uint8Array(e),a=x.FL.fromBinary(t),n=a.type;console.log(`[${(0,r.GE)()}] server message received: ${(0,x.aW)(n)}`),this.OnDataReceived(a)}))}Initialize(){}Send(e){const t=x.FL.toBinary(e);this.Socket.emit(x.D2,t)}SendMessage(e,t,a){const n=x.FL.create();n.type=e;const s=x.wL.create();void 0!==t&&(s.p1=x.NM.create({valueInt32:t})),void 0!==a&&(s.p2=x.NM.create({valueInt32:a})),n.parameter=s,this.Send(n)}}const w=new A,D={title:{text:"realtime signal"},tooltip:{trigger:"axis",formatter(e){const t=e[0],a=new Date(t.value[0]);return`${(0,r.r2)(a)} : ${t.value[1]}`},axisPointer:{animation:!1}},xAxis:{type:"value",scale:!0,splitLine:{show:!1}},yAxis:{type:"value",scale:!0,boundaryGap:[0,"100%"],splitLine:{show:!1}},series:[{name:"Sine",type:"line",showSymbol:!1,hoverAnimation:!1}]},b=(0,n.aZ)({name:"IoTPage",components:{Chart:_},props:{reserved:{type:String,default:()=>""}},data(){return{frequency:200,sampleRate:1e3,isRefresh:!1,delay:1e3,frame:x.a8.create(),options:D}},computed:{Chart(){return this.$refs.chart.Chart}},methods:{handleMessage(e){const t=e.type;if(t===x.GC.KAVEN_MESSAGE_TYPE_GET_DISPLAY_DATA_OK||t===x.GC.KAVEN_MESSAGE_TYPE_NEW_DISPLAY_DATA){this.frame=x.a8.fromBinary(e.data);const t=this.frame.data.map((e=>e.values)),a=(e,t=.2)=>{const a=Math.min(...e),n=Math.max(...e),s=(n-a)*t;return{min:a-s,max:n+s}},n=t.map((e=>e[0])),s=t.map((e=>e[1]));return this.Chart.setOption({series:[{data:t}],xAxis:a(n,.02),yAxis:a(s)}),setTimeout((()=>{this.isRefresh&&this.sendDisplayNext()}),this.delay),!0}return!1},sendDisplayNext(){w.SendMessage(x.GC.KAVEN_MESSAGE_TYPE_GET_DISPLAY_DATA,this.frequency,this.sampleRate)}},watch:{isRefresh(e){e&&this.sendDisplayNext()}},created(){w.Initialize()},mounted(){w.DataReceived.on(this.handleMessage)},unmounted(){w.DataReceived.off(this.handleMessage)}});var E=a(75267),V=a(24238),M=a(51464),C=a(25652),R=a(1068),W=a(54426),q=a(8723),T=a.n(q);const k=(0,y.Z)(b,[["render",o]]),G=k;T()(b,"components",{QCard:E.Z,QCardSection:V.Z,QInput:M.Z,QIcon:C.Z,QSpace:R.Z,QToggle:W.Z})}}]);